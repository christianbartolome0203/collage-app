<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collage App - Pride Edition</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f7fb;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  margin: 0;
}

.board {
  display: grid;
  gap: 4px;
  background: #eef2ff;
  border-radius: 12px;
  width: 90vw;
  max-width: 600px;
  aspect-ratio: 1/1;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
}

.cell {
  background: #eceff6;
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: 1px solid rgba(15, 23, 42, 0.06);
  perspective: 800px;
  position: relative;
  flex-shrink: 0;
}

.cell-inner {
  width: 100%;
  height: 100%;
  transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
  transform-style: preserve-3d;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cell img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center center;
  backface-visibility: hidden;
  border-radius: 8px;
  display: block;
}

.cell.center img {
  object-fit: contain;
}

.center-overlay {
  position: absolute;
  bottom: 5px;
  left: 0;
  width: 100%;
  z-index: 10;
  color: #fff;
  font-weight: bold;
  font-size: 14px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 6px;
  pointer-events: none;
  text-shadow: 1px 1px 3px #000;
}

/* Auto-scrolling library */
.library {
  display: flex;
  overflow-x: hidden;
  gap: 6px;
  max-height: 100px;
  margin-top: 12px;
  padding: 6px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  width: 90vw;
  max-width: 600px;
  position: relative;
}

.library-inner {
  display: flex;
  gap: 6px;
  animation: scrollLeft 20s linear infinite;
}

@keyframes scrollLeft {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

.library img {
  flex: 0 0 auto;
  width: 48px;
  height: 48px;
  object-fit: cover;
  border-radius: 6px;
  cursor: grab;
  border: 1px solid #cbd5e1;
}

@media (max-width: 480px){
  .library img { width: 40px; height: 40px; }
  .board { gap: 3px; }
}
</style>
</head>
<body>

<div class="board" id="board"></div>
<div class="library" id="library">
  <div class="library-inner" id="libraryInner"></div>
</div>
<audio id="shuffleSound" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>

<script>
const boardEl = document.getElementById('board');
const libraryInner = document.getElementById('libraryInner');
const shuffleSound = document.getElementById('shuffleSound');

const grid = 3;
let cells = [];

const centerImageSrc = "https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(11).jpg";

// Library images excluding center
const libraryURLs = [
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/08d659392_Mockup7.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/1b1d214df_Mockup1.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/55fdaf344_Mockup3.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/62da92f9e_Mockup8.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/56c98e0b1_Mockup4.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/9a7405c30_Mockup6.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/d88708189_Mockup5.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(1).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(10).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(2).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(3).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(4).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(5).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(6).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(8).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download%20(9).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/download.jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/ec4023f63_Mockup2.png",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/images%20(1).jpg",
"https://raw.githubusercontent.com/christianbartolome0203/collage-app/main/library/images.jpg"
];
const library = libraryURLs.map(url => { const img = new Image(); img.src = url; return img; });

function init(){
  cells = Array(grid*grid).fill(null).map(()=>({ img:null, src:null }));
  const centerIndex = Math.floor(grid*grid/2);

  let shuffled = [...library];
  for(let i=shuffled.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [shuffled[i],shuffled[j]]=[shuffled[j],shuffled[i]];
  }

  let libIdx = 0;
  cells.forEach((cell,i)=>{
    if(i!==centerIndex){
      cells[i] = { img: shuffled[libIdx], src: shuffled[libIdx].src };
      libIdx++;
    }
  });

  renderBoard();
  renderLibrary();
}

function renderLibrary(){
  libraryInner.innerHTML = '';

  // Duplicate images for seamless scrolling
  const fullList = [...library, ...library];
  fullList.forEach(img=>{
    const thumb = document.createElement('img');
    thumb.src = img.src;
    thumb.draggable = true;

    // Desktop drag
    thumb.addEventListener('dragstart', e=>{
      e.dataTransfer.setData('text/plain', img.src);
    });

    // Mobile touch drag
    thumb.addEventListener('touchstart', e=>{
      e.target.dataset.dragSrc = img.src;
    });

    libraryInner.appendChild(thumb);
  });
}

function renderBoard(){
  const centerIndex = Math.floor(grid*grid/2);
  boardEl.innerHTML = '';
  cells.forEach((cell,i)=>{
    const div = document.createElement('div');
    div.className='cell';
    if(i===centerIndex) div.classList.add('center');

    const innerDiv = document.createElement('div');
    innerDiv.className='cell-inner';

    const imgEl = document.createElement('img');
    imgEl.src = (i===centerIndex)? centerImageSrc : (cell.src || '');
    innerDiv.appendChild(imgEl);

    if(i===centerIndex){
      const overlay = document.createElement('div');
      overlay.className='center-overlay';
      overlay.textContent = "Click Me to Shuffle!";
      div.appendChild(overlay);
      div.addEventListener('click', randomizeOtherTiles);
    }

    div.appendChild(innerDiv);

    if(i!==centerIndex){
      div.addEventListener('dragover', e=>e.preventDefault());
      div.addEventListener('drop', e=>{
        e.preventDefault();
        const src = e.dataTransfer?.getData('text/plain') || e.target.dataset?.dragSrc;
        if(src){
          cells[i] = { img:null, src };
          renderBoard();
        }
      });
      div.addEventListener('touchend', e=>{
        const src = e.target.dataset?.dragSrc || e.target.closest('[data-drag-src]')?.dataset.dragSrc;
        if(src){
          cells[i] = { img:null, src };
          renderBoard();
        }
      });
    }

    boardEl.appendChild(div);
  });
}

function randomizeOtherTiles(){
  shuffleSound.currentTime=0;
  shuffleSound.play();

  const centerIndex = Math.floor(grid*grid/2);
  let shuffled = [...library];
  for(let i=shuffled.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [shuffled[i],shuffled[j]]=[shuffled[j],shuffled[i]];
  }

  let libIdx = 0;
  cells.forEach((cell,i)=>{
    if(i!==centerIndex){
      const div = boardEl.children[i];
      const inner = div.querySelector('.cell-inner');
      inner.style.transform='rotateY(360deg) scale(1)';
      setTimeout(()=>{
        cells[i]={ img:shuffled[libIdx], src:shuffled[libIdx].src };
        renderBoard();
        libIdx++;
      }, 400);
    }
  });
}

init();
</script>
</body>
</html>
